{"ast":null,"code":"var _jsxFileName = \"/home/rootb/Escritorio/habilitacion/meetapp-fe/src/views/reservar/Mesas.jsx\",\n    _s = $RefreshSig$();\n\nimport Swal from 'sweetalert2';\nimport withReactContent from 'sweetalert2-react-content';\nimport { useAuth0 } from \"@auth0/auth0-react\";\nimport React, { useState, useEffect, useRef } from 'react';\nimport { useHistory } from 'react-router';\nimport { withRouter, useParams } from \"react-router-dom\";\nimport Mesa from './Mesa';\nimport axios from \"axios\";\nimport Loading from './../../layout/Loading';\nimport uniqid from 'uniqid';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nconst Mesas = () => {\n  _s();\n\n  const {\n    user\n  } = useAuth0();\n  let {\n    email\n  } = user;\n  let history = useHistory();\n  let {\n    local,\n    fecha,\n    hora\n  } = useParams(); //console.log(useParams())\n\n  const disponibleRef = useRef(null);\n  const [piso, setPiso] = useState(1);\n  const [cantidadPisos, setCantidadPisos] = useState({});\n  const [acompaniantes, setAcompaniantes] = useState(0);\n  const [form, setForm] = useState({});\n  const [mesas, setMesas] = useState({});\n\n  const cargarReservas = piso => {\n    setForm({});\n    setMesas({\n      mesas: [],\n      status: false\n    }); //\n\n    let url = `http://localhost:5000/api/local/${local}/piso/${piso}/mesas/fecha/${fecha}/hora/${hora}`;\n    axios.get(url).then(res => setMesas({\n      mesas: res.data,\n      status: true\n    }));\n  }; // eslint-disable-next-line\n\n\n  useEffect(_ => cargarReservas(piso), [piso]);\n  console.log(mesas, \"jdkjdkdjkdjkkkkkkkkkk\");\n\n  const obtenerPisos = () => {\n    let urlPisos = `http://localhost:5000/api/cantidad-de-pisos/local/${local}/  `;\n    axios.get(urlPisos).then(res => setCantidadPisos({\n      pisos: res.data,\n      status: true\n    }));\n  }; // eslint-disable-next-line\n\n\n  useEffect(_ => obtenerPisos(), []);\n\n  const selectPisos = cantidadPisos => {\n    const opt = [];\n    const maxPisos = cantidadPisos.pisos[0].pisos;\n\n    for (let n = 2; n <= maxPisos; n++) {\n      opt.push( /*#__PURE__*/_jsxDEV(\"option\", {\n        value: n,\n        children: [n, \"\\xBA piso\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 70,\n        columnNumber: 9\n      }, this));\n    }\n\n    return opt;\n  }; //console.log(cantidadPisos.status)\n\n\n  const bodyMesas = _ref => {\n    let {\n      mesas\n    } = _ref;\n    let lugar = 0;\n    let table = [];\n    let y = mesas[0].length;\n    let encabezado = [];\n    encabezado.push( /*#__PURE__*/_jsxDEV(\"th\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 21\n    }, this));\n\n    for (let j = 0; j < y; j++) {\n      encabezado.push( /*#__PURE__*/_jsxDEV(\"th\", {\n        children: j + 1\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 89,\n        columnNumber: 9\n      }, this));\n    }\n\n    table.push( /*#__PURE__*/_jsxDEV(\"tr\", {\n      children: encabezado\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 16\n    }, this));\n\n    for (let i = 0; i < mesas.length; i++) {\n      let content = [];\n      content.push( /*#__PURE__*/_jsxDEV(\"td\", {\n        children: i + 1\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 11\n      }, this));\n\n      for (let j = 0; j < y; j++) {\n        if (mesas[i][j].disponible) {\n          lugar += mesas[i][j].capacidad;\n        }\n\n        content.push( /*#__PURE__*/_jsxDEV(Mesa, {\n          disponible: mesas[i][j].disponible,\n          asientos: mesas[i][j].capacidad,\n          id: mesas[i][j].id,\n          numero: mesas[i][j].numero,\n          handleChecked: handleChecked\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 110,\n          columnNumber: 11\n        }, this));\n      }\n\n      table.push( /*#__PURE__*/_jsxDEV(\"tr\", {\n        children: content\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 120,\n        columnNumber: 9\n      }, this));\n    }\n\n    disponibleRef.current.innerHTML = `Lugares disponibles: ${lugar}`;\n    return table;\n  };\n\n  const handleSelectOnChanged = e => setPiso(e.target.value);\n\n  const handleChanged = event => {\n    //console.log(\"changed\")\n    let {\n      value,\n      min,\n      max\n    } = event.target;\n    value = Math.max(Number(min), Math.min(Number(max), Number(value)));\n    setAcompaniantes(value);\n  };\n\n  const handleChecked = event => {\n    //console.log(\"checked\")\n    let {\n      id,\n      className,\n      checked\n    } = event.target;\n    if (!checked) delete form[id];else setForm({ ...form,\n      [id]: className\n    });\n  };\n\n  const handleSubmit = event => {\n    event.preventDefault(); //alert(`Reserva hecha para ${local} en el piso ${piso}, fecha ${fecha},hora ${hora}, cantidad de acompañantes ${acompaniantes}`)\n    //alert(JSON.stringify({local, piso, fecha, hora, acompaniantes, ...form}))\n\n    let asistentes = acompaniantes + 1;\n    let asistentes2 = acompaniantes + 1;\n    console.log(acompaniantes, \"fhjfhfjh\");\n    let capacidadMesas = Object.values(form);\n    let excedeMesas = false;\n    let cantidadDesillas = 0;\n    capacidadMesas.reverse().forEach((mesa, i) => {\n      asistentes -= mesa;\n      cantidadDesillas += parseInt(mesa);\n\n      if (asistentes <= 0 && i !== capacidadMesas.length - 1) {\n        excedeMesas = true;\n        return;\n      }\n    });\n    console.log(parseInt(cantidadDesillas));\n    console.log(parseInt(asistentes));\n    console.log(parseInt(cantidadDesillas) < parseInt(asistentes));\n    const MySwal = withReactContent(Swal);\n    const MySwal2 = withReactContent(Swal);\n\n    if (excedeMesas) {\n      MySwal.fire({\n        title: `Selecciona menos mesas para reservar`,\n        text: `La cantidad de comensales incluyendote, es mucho menor a las mesas que solicita reservar`,\n        icon: 'warning',\n        showCancelButton: false,\n        confirmButtonText: '<i class=\"fa fa-thumbs-up\"></i> entendido',\n        reverseButtons: false\n      });\n      return;\n    }\n\n    if (cantidadDesillas < asistentes2) {\n      MySwal2.fire({\n        title: `Selecciona más mesas para reservar`,\n        text: `La cantidad de asisentos para los comensales incluyendote,no es suficiente selecciona más mesas`,\n        icon: 'warning',\n        showCancelButton: false,\n        confirmButtonText: '<i class=\"fa fa-thumbs-up\"></i> entendido',\n        reverseButtons: false\n      });\n      return;\n    }\n\n    const swalWithBootstrapButtons = Swal.mixin({\n      customClass: {\n        confirmButton: 'btn btn-success',\n        cancelButton: 'btn btn-danger'\n      },\n      buttonsStyling: false\n    });\n    swalWithBootstrapButtons.fire({\n      title: `¿Desea confirmar la reserva para ${local} en el piso ${piso}?`,\n      text: `fecha: ${fecha}, hora: ${hora}, con ${acompaniantes}  acompañantes`,\n      icon: 'question',\n      allowOutsideClick: false,\n      showCancelButton: true,\n      cancelButtonText: '<i class=\"fas fa-times\"></i> Cancelar',\n      confirmButtonText: '<i class=\"fas fa-check\"></i> Confirmar',\n      reverseButtons: false\n    }).then(result => {\n      if (result.isConfirmed) {\n        swalWithBootstrapButtons.fire({\n          title: `Reserva para ir a ${local} confirmada`,\n          text: `tu reserva ha sido confirmada para el ${fecha}, a la  hora: ${hora} `,\n          icon: 'success',\n          showCancelButton: false,\n          confirmButtonText: '<i class=\"fas fa-check\"></i> Confirmar',\n          reverseButtons: false\n        });\n        let idMesasReservadas = Object.keys(form);\n        let mesas_reservas = idMesasReservadas.map(mesaId => {\n          return {\n            mesaId\n          };\n        });\n        axios.post(`http://localhost:5000/api/reservas`, {\n          fecha,\n          hora,\n          cantidad_reservada: asistentes2,\n          estadoId: 1,\n          comensaleId: email,\n          mesas_reservas\n        }).then(res => {\n          console.log(res);\n          console.log(res.data);\n          history.push('/mis-reservas');\n        }).catch(e => {\n          console.log(e);\n        });\n      } else if (\n      /* Read more about handling dismissals below */\n      result.dismiss === Swal.DismissReason.cancel) {\n        swalWithBootstrapButtons.fire({\n          title: `Reserva cancelada`,\n          text: `tu reserva ha sido cancelada`,\n          icon: 'error',\n          showCancelButton: false,\n          confirmButtonText: '<i class=\"fas fa-check\"></i> Confirmar',\n          reverseButtons: false\n        });\n      }\n    });\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"form\", {\n    className: \"container container-fluid\",\n    onSubmit: handleSubmit,\n    children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n      className: \"text-dark mb-4\",\n      children: /*#__PURE__*/_jsxDEV(\"strong\", {\n        children: [\"Reserva de Mesas en \", local.charAt(0).toUpperCase() + local.slice(1)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 292,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 291,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"card-body\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"row\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"col-md-4 text-center\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            style: {\n              margin: '0px',\n              width: '180px'\n            },\n            title: \"ingresa la cantidad de acompa\\xF1antes\",\n            children: \"Acompa\\xF1antes\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 300,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            title: \"ingresa la cantidad de acompa\\xF1antes\",\n            autoFocus: true,\n            type: \"number\",\n            min: 0,\n            max: 10,\n            id: \"acompaniantes\",\n            name: \"acompaniantes\",\n            value: acompaniantes,\n            onChange: handleChanged\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 306,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 299,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"col-md-4 text-center\",\n          children: /*#__PURE__*/_jsxDEV(\"label\", {\n            style: {\n              margin: '0px',\n              width: '180px'\n            },\n            title: \"lugares disponibles para reservar en este piso\",\n            children: /*#__PURE__*/_jsxDEV(\"strong\", {\n              ref: disponibleRef\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 322,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 318,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 317,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"col-md-4 text-center\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            style: {\n              width: '180px'\n            },\n            children: \"Piso del local\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 326,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n            onChange: handleSelectOnChanged,\n            value: piso,\n            title: \"seleccione un piso para ver las mesas\",\n            children: /*#__PURE__*/_jsxDEV(\"optgroup\", {\n              label: \"Seleccione un piso\",\n              children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                value: 1,\n                children: \"1\\xBA piso\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 335,\n                columnNumber: 17\n              }, this), cantidadPisos.status === true ? selectPisos(cantidadPisos) : /*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"cargando...\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 344,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 334,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 329,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 325,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 298,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 297,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"card shadow\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"card-header py-3\",\n        children: /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-primary m-0 font-weight-bold\",\n          children: \"Seleccione las mesas a reservar:\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 356,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 355,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"card-body\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"table-responsive table mt-2\",\n          id: \"dataTable\",\n          role: \"grid\",\n          \"aria-describedby\": \"dataTable_info\",\n          children: /*#__PURE__*/_jsxDEV(\"table\", {\n            className: \"table my-0\",\n            id: \"dataTable\",\n            children: mesas.status ? /*#__PURE__*/_jsxDEV(_Fragment, {\n              children: [/*#__PURE__*/_jsxDEV(\"thead\", {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 370,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"tbody\", {\n                children: bodyMesas(mesas)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 372,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"tfoot\", {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 375,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true) : /*#__PURE__*/_jsxDEV(\"td\", {\n              children: /*#__PURE__*/_jsxDEV(Loading, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 380,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 379,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 367,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 361,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 360,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 354,\n      columnNumber: 7\n    }, this), mesas.status ? /*#__PURE__*/_jsxDEV(\"button\", {\n      className: \"btn btn-success d-flex mx-auto mt-3\",\n      style: {\n        marginTop: '10px',\n        marginBottom: '30px'\n      },\n      title: \"confirmar reserva con los datos proporcionados\",\n      children: [/*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"icon text-white-20\",\n        children: /*#__PURE__*/_jsxDEV(\"i\", {\n          className: \"fas fa-check fa\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 394,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 393,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n        class: \"text\",\n        children: \"Confirmar \"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 396,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 388,\n      columnNumber: 9\n    }, this) : /*#__PURE__*/_jsxDEV(\"span\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 400,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 290,\n    columnNumber: 5\n  }, this);\n};\n\n_s(Mesas, \"Wtf5lcRLv/NDOU3BEBz/55RJBjs=\", false, function () {\n  return [useAuth0, useHistory, useParams];\n});\n\n_c = Mesas;\nexport default _c2 = withRouter(Mesas);\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"Mesas\");\n$RefreshReg$(_c2, \"%default%\");","map":{"version":3,"sources":["/home/rootb/Escritorio/habilitacion/meetapp-fe/src/views/reservar/Mesas.jsx"],"names":["Swal","withReactContent","useAuth0","React","useState","useEffect","useRef","useHistory","withRouter","useParams","Mesa","axios","Loading","uniqid","Mesas","user","email","history","local","fecha","hora","disponibleRef","piso","setPiso","cantidadPisos","setCantidadPisos","acompaniantes","setAcompaniantes","form","setForm","mesas","setMesas","cargarReservas","status","url","get","then","res","data","_","console","log","obtenerPisos","urlPisos","pisos","selectPisos","opt","maxPisos","n","push","bodyMesas","lugar","table","y","length","encabezado","j","i","content","disponible","capacidad","id","numero","handleChecked","current","innerHTML","handleSelectOnChanged","e","target","value","handleChanged","event","min","max","Math","Number","className","checked","handleSubmit","preventDefault","asistentes","asistentes2","capacidadMesas","Object","values","excedeMesas","cantidadDesillas","reverse","forEach","mesa","parseInt","MySwal","MySwal2","fire","title","text","icon","showCancelButton","confirmButtonText","reverseButtons","swalWithBootstrapButtons","mixin","customClass","confirmButton","cancelButton","buttonsStyling","allowOutsideClick","cancelButtonText","result","isConfirmed","idMesasReservadas","keys","mesas_reservas","map","mesaId","post","cantidad_reservada","estadoId","comensaleId","catch","dismiss","DismissReason","cancel","charAt","toUpperCase","slice","margin","width","marginTop","marginBottom"],"mappings":"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","sourcesContent":["import Swal from 'sweetalert2'\r\nimport withReactContent from 'sweetalert2-react-content'\r\nimport { useAuth0 } from \"@auth0/auth0-react\";\r\n\r\n  \r\n\r\nimport React, {useState,useEffect,useRef} from 'react';\r\nimport { useHistory } from 'react-router';\r\nimport {withRouter, useParams} from \"react-router-dom\";\r\nimport Mesa from './Mesa';\r\nimport axios from \"axios\";\r\nimport Loading from './../../layout/Loading';\r\nimport uniqid from 'uniqid';\r\nconst Mesas = () => {\r\n  const { user } = useAuth0();\r\n  let {email } =user;\r\n  let history=useHistory();\r\n  let {local,fecha,hora} = useParams();\r\n  //console.log(useParams())\r\n  const disponibleRef = useRef(null);\r\n  const [piso, setPiso]=useState(1);\r\n  const [cantidadPisos,setCantidadPisos]=useState({});\r\n  const [acompaniantes, setAcompaniantes]=useState(0);\r\n  const [form, setForm]=useState({});\r\n  const [mesas, setMesas] = useState({});\r\n  const cargarReservas = (piso) => {\r\n    setForm(\r\n      {}\r\n    );\r\n    setMesas(\r\n      {\r\n        mesas: [], \r\n        status: false\r\n      }\r\n    );\r\n    //\r\n    let url = `http://localhost:5000/api/local/${local}/piso/${piso}/mesas/fecha/${fecha}/hora/${hora}`;\r\n    axios.get(url)\r\n    .then(res => \r\n      setMesas(\r\n        {\r\n          mesas: res.data,\r\n          status: true\r\n        }\r\n      )\r\n    );\r\n  }\r\n  // eslint-disable-next-line\r\n  useEffect (_=> cargarReservas(piso), [piso] );\r\n  console.log(mesas,\"jdkjdkdjkdjkkkkkkkkkk\")\r\n  const obtenerPisos = () => {\r\n  let urlPisos = `http://localhost:5000/api/cantidad-de-pisos/local/${local}/  `;\r\n    axios.get(urlPisos)\r\n    .then(res => \r\n      setCantidadPisos(\r\n        {\r\n          pisos: res.data,\r\n          status: true\r\n        }\r\n      )\r\n    );\r\n  }\r\n  // eslint-disable-next-line\r\n  useEffect (_=> obtenerPisos(), [] );\r\n  const selectPisos=(cantidadPisos)=>{\r\n    const opt=[];\r\n    const maxPisos= cantidadPisos.pisos[0].pisos\r\n    for (let n = 2; n <= maxPisos; n++) {\r\n      opt.push(\r\n        <option value={n}> \r\n         {n}º piso\r\n        </option>\r\n      )\r\n    }\r\n    return opt;\r\n  } \r\n\r\n //console.log(cantidadPisos.status)\r\n\r\n  const bodyMesas = ({mesas}) => {\r\n    let lugar=0\r\n    let table = []; \r\n    let y= mesas[0].length;\r\n  \r\n    let encabezado=[];\r\n    encabezado.push(<th></th>)\r\n    for (let j = 0; j < y; j++) {\r\n      encabezado.push(\r\n        <th>\r\n          {j+1}\r\n        </th>\r\n      )\r\n    }\r\n    table.push(<tr>{encabezado}</tr>)\r\n    for (let i = 0; i < mesas.length; i++) {\r\n      let content = []; \r\n      content.push(\r\n          <td>\r\n            {i+1}\r\n          </td>\r\n        )\r\n        \r\n      for (let j = 0; j <y; j++) {  \r\n        \r\n        if(mesas[i][j].disponible){\r\n          lugar+=mesas[i][j].capacidad\r\n        }\r\n        \r\n        content.push(\r\n          <Mesa\r\n            disponible={mesas[i][j].disponible}\r\n            asientos={mesas[i][j].capacidad}\r\n            id={mesas[i][j].id}\r\n            numero={mesas[i][j].numero}\r\n            handleChecked={handleChecked}\r\n          />\r\n        );\r\n      }\r\n      table.push(\r\n        <tr>\r\n          {content}\r\n        </tr>\r\n      )\r\n    }\r\n    disponibleRef.current.innerHTML=`Lugares disponibles: ${lugar}`;\r\n    return table    \r\n  };\r\n    \r\n      \r\n  const handleSelectOnChanged=(e)=>setPiso(e.target.value);\r\n\r\n  const handleChanged=(event)=>{\r\n    //console.log(\"changed\")\r\n    let { value, min, max} = event.target;\r\n    value = Math\r\n    .max(\r\n      Number(min), \r\n      Math.min(\r\n        Number(max), \r\n        Number(value)\r\n      )\r\n    );\r\n    setAcompaniantes(value);\r\n  } \r\n  const handleChecked=(event)=>{\r\n    //console.log(\"checked\")\r\n    let {id, className, checked} = event.target;\r\n    if (!checked)\r\n        delete form[id]\r\n    else\r\n      setForm(\r\n        {\r\n          ...form,\r\n          [id]:className,\r\n        }\r\n      )\r\n  }\r\n  const handleSubmit=(event)=>{\r\n    event.preventDefault();\r\n    //alert(`Reserva hecha para ${local} en el piso ${piso}, fecha ${fecha},hora ${hora}, cantidad de acompañantes ${acompaniantes}`)\r\n    //alert(JSON.stringify({local, piso, fecha, hora, acompaniantes, ...form}))\r\n    \r\n    \r\n    let asistentes=acompaniantes+1;\r\n    let asistentes2=acompaniantes+1;\r\n    console.log(acompaniantes,\"fhjfhfjh\")\r\n    let capacidadMesas=Object.values(form);\r\n    let excedeMesas=false;\r\n    let cantidadDesillas=0;\r\n    capacidadMesas.reverse()\r\n      .forEach((mesa,i) => {\r\n        asistentes-=mesa;\r\n        cantidadDesillas+=parseInt(mesa);\r\n\r\n        if (asistentes<=0 && i!==capacidadMesas.length-1){\r\n          excedeMesas=true;    \r\n          return \r\n        }\r\n      }\r\n      );\r\n      console.log(parseInt(cantidadDesillas)) \r\n      console.log(parseInt(asistentes))\r\n\r\n      console.log(parseInt(cantidadDesillas) < parseInt(asistentes))\r\n   \r\n    const MySwal = withReactContent(Swal)\r\n    const MySwal2 = withReactContent(Swal)\r\n    if (excedeMesas) {\r\n     \r\n      MySwal.fire(\r\n        {\r\n          title: `Selecciona menos mesas para reservar`,\r\n          text: `La cantidad de comensales incluyendote, es mucho menor a las mesas que solicita reservar`,\r\n          icon: 'warning',\r\n          showCancelButton: false,\r\n          confirmButtonText: '<i class=\"fa fa-thumbs-up\"></i> entendido',\r\n          reverseButtons: false\r\n        }\r\n      )\r\n      \r\n      return\r\n    }\r\n    if(cantidadDesillas < asistentes2){\r\n      MySwal2.fire(\r\n        {\r\n          title: `Selecciona más mesas para reservar`,\r\n          text: `La cantidad de asisentos para los comensales incluyendote,no es suficiente selecciona más mesas`,\r\n          icon: 'warning',\r\n          showCancelButton: false,\r\n          confirmButtonText: '<i class=\"fa fa-thumbs-up\"></i> entendido',\r\n          reverseButtons: false\r\n        }\r\n      )\r\n      return\r\n    }\r\n    \r\n    \r\n    const swalWithBootstrapButtons = Swal.mixin(\r\n      {\r\n        customClass: {\r\n          confirmButton: 'btn btn-success',\r\n          cancelButton: 'btn btn-danger'\r\n        },\r\n        buttonsStyling: false\r\n      }\r\n    );\r\n   \r\n    swalWithBootstrapButtons.fire(\r\n      {\r\n        title: `¿Desea confirmar la reserva para ${local} en el piso ${piso}?`,\r\n        text: `fecha: ${fecha}, hora: ${hora}, con ${acompaniantes}  acompañantes`,\r\n        icon: 'question',\r\n        allowOutsideClick: false,\r\n        showCancelButton: true,\r\n        cancelButtonText: '<i class=\"fas fa-times\"></i> Cancelar',\r\n        confirmButtonText: '<i class=\"fas fa-check\"></i> Confirmar',\r\n        reverseButtons: false\r\n      }\r\n    ).then((result) => {\r\n      if (result.isConfirmed) {\r\n        swalWithBootstrapButtons.fire(\r\n          {\r\n            title: `Reserva para ir a ${local} confirmada`,\r\n            text: `tu reserva ha sido confirmada para el ${fecha}, a la  hora: ${hora} `,\r\n            icon: 'success',\r\n            showCancelButton: false,\r\n            confirmButtonText: '<i class=\"fas fa-check\"></i> Confirmar',\r\n            reverseButtons: false,\r\n          }\r\n        );\r\n\r\n        \r\n        let idMesasReservadas=Object.keys(form);\r\n        let mesas_reservas=idMesasReservadas.map(mesaId=>{return{mesaId}})\r\n        axios.post(`http://localhost:5000/api/reservas`, {\r\n          fecha,\r\n          hora,\r\n          cantidad_reservada:asistentes2,\r\n          estadoId:1,\r\n          comensaleId:email,\r\n          mesas_reservas\r\n       })\r\n          .then(res => {\r\n            console.log(res);\r\n            console.log(res.data);\r\n            history.push('/mis-reservas');\r\n          }).catch(e => {\r\n            console.log(e);\r\n        })\r\n        \r\n      } else if (\r\n        /* Read more about handling dismissals below */\r\n        result.dismiss === Swal.DismissReason.cancel\r\n      ) {\r\n        swalWithBootstrapButtons.fire(\r\n          {\r\n            title: `Reserva cancelada`,\r\n            text: `tu reserva ha sido cancelada`,\r\n            icon: 'error',\r\n            showCancelButton: false,\r\n            confirmButtonText: '<i class=\"fas fa-check\"></i> Confirmar',\r\n            reverseButtons: false\r\n          }\r\n        )\r\n      }\r\n    });\r\n    \r\n  }\r\n  return (\r\n    <form className=\"container container-fluid\" onSubmit={handleSubmit}>\r\n      <h3 className=\"text-dark mb-4\">\r\n        <strong>\r\n          Reserva de Mesas en {local.charAt(0).toUpperCase() + local.slice(1)}\r\n        </strong>\r\n      </h3>\r\n\r\n      <div className=\"card-body\">\r\n        <div className=\"row\">\r\n          <div className=\"col-md-4 text-center\">\r\n            <label \r\n              style={{margin: '0px', width: '180px'}}\r\n              title=\"ingresa la cantidad de acompañantes\"\r\n            >\r\n              Acompañantes\r\n            </label>\r\n            <input\r\n              title=\"ingresa la cantidad de acompañantes\" \r\n              autoFocus\r\n              type=\"number\" \r\n              min={0} max={10} \r\n              id=\"acompaniantes\" \r\n              name=\"acompaniantes\" \r\n              value={acompaniantes} \r\n              onChange={handleChanged}\r\n            />\r\n          </div>\r\n          <div className=\"col-md-4 text-center\">\r\n            <label  \r\n              style={{margin: '0px', width: '180px'}}\r\n              title=\"lugares disponibles para reservar en este piso\"\r\n            >\r\n              <strong ref={disponibleRef}/>\r\n            </label>\r\n          </div>\r\n          <div className=\"col-md-4 text-center\">\r\n            <label style={{width: '180px'}}>\r\n              Piso del local \r\n            </label>\r\n            <select \r\n              onChange={handleSelectOnChanged}\r\n              value={piso}\r\n              title=\"seleccione un piso para ver las mesas\"\r\n            >\r\n              <optgroup label=\"Seleccione un piso\">\r\n                <option \r\n                  value={1} \r\n                >\r\n                  1º piso\r\n                </option>\r\n                {\r\n                  cantidadPisos.status===true? \r\n                    selectPisos(cantidadPisos) \r\n                    :\r\n                    <strong>\r\n                      cargando...\r\n                    </strong>\r\n                }\r\n              </optgroup>\r\n            </select>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"card shadow\">\r\n        <div className=\"card-header py-3\">\r\n          <p className=\"text-primary m-0 font-weight-bold\">\r\n            Seleccione las mesas a reservar:\r\n          </p>\r\n        </div>\r\n        <div className=\"card-body\">\r\n          <div\r\n            className=\"table-responsive table mt-2\"\r\n            id=\"dataTable\"\r\n            role=\"grid\"\r\n            aria-describedby=\"dataTable_info\"\r\n          >\r\n            <table className=\"table my-0\" id=\"dataTable\">\r\n              {mesas.status ?  \r\n                <>\r\n                  <thead>\r\n                  </thead>\r\n                  <tbody> \r\n                  {bodyMesas(mesas)}\r\n                  </tbody>\r\n                  <tfoot>\r\n                  </tfoot>\r\n                </>\r\n                :\r\n                <td>\r\n                  <Loading/>\r\n                </td>\r\n              }\r\n            </table>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      {mesas.status ?  \r\n        <button\r\n          className=\"btn btn-success d-flex mx-auto mt-3\"\r\n          style={{ marginTop: '10px', marginBottom: '30px'}}\r\n          title=\"confirmar reserva con los datos proporcionados\"\r\n        >\r\n          <span className=\"icon text-white-20\" >\r\n            <i className=\"fas fa-check fa\"/>\r\n          </span>\r\n          <span class=\"text\">Confirmar </span>  \r\n          \r\n        </button>\r\n        :\r\n        <span/>\r\n      }\r\n    </form>\r\n  );\r\n};\r\n\r\nexport default withRouter( Mesas);\r\n"]},"metadata":{},"sourceType":"module"}